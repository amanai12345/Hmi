const jsonData = {
   shapes: [
      {
      props: {
        shape: "polygon",
        
        x: 20,
        y: 750,
        vertices: [
          { x:0, y: 0 },
          { x: 770, y: 0 },
          { x: 770, y: -600 },
          { x: 0, y: -600 },
          { x: 0, y: 0 },
          
         
        ],
      
      fillStyle: { style: "#a8a8a8" },
        // strokeStyle: { style: "#848484" },
        lw: { value: 1 }
      }
    },
      {
      props: {
        shape: "polygon",
        
        x: 970,
        y: 420,
        vertices: [
          { x:0, y: 0 },
          { x: -1, y:204.52 },
          { x: 170, y: 204.52 },
          { x: 170, y: 0 },
          { x: 0, y: 0 },
          
         
        ],
      
      fillStyle: { style: "#a8a8a8" },
       strokeStyle: { style: "#848484" },
        lw: { value: 1 }
      }
    },
   {
      props: {
        shape: "polyline",
      
        x: 1455,
        y: 610,
        vertices: [
          { x: 3 , y: 20},
          { x: 0 , y: -450, isArc: true, radius: 10 },
          {  x: -1290, y: -450,isArc: true, radius: 10 },
          { x: -1290, y: -340 },  
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
    {
      props: {
        shape: "polyline",
      
        x: 810,
        y: 780,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: -260,isArc: true, radius: 10 },
          { x: 380, y: -260,isArc: true, radius: 10 },
        
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" },
        dash:[6, 6]
      }
    },
      {
      props: {
        shape: "polyline",
        x: 1200,
        y: 520,
        vertices: [
          { x: 4.58, y: 0.14 },
          { x: 94.98, y: 0.14},
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" },
        dash:[6, 6]
      }
    },
       {
      props: {
        shape: "polyline",
        x: 1300,
        y: 520,
        vertices: [
          { x: 8.18, y: -0.14 },
          { x: 150.84, y: -0.13},
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" },
        dash:[6, 6]
      }
    },
     {
      props: {
        shape: "polyline",
        x: 1465,
        y: 520,
        vertices: [
          { x: -1.75, y: -0.5 },
          { x: 50, y: 0,isArc: true, radius: 10 },
          { x: 50, y: 110,isArc: true, radius: 10 },
        
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" },
        dash:[6, 6]
      }
    },
    {
      props: {
        shape: "polyline",
        x: 850,
        y: 990,
        vertices: [
          { x: 0, y: 0 },
          { x: 610, y: 0,isArc: true, radius: 10 },
          { x: 610, y: -190,isArc: true, radius: 10 },
         
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
    {
      props: {
        shape: "polyline",
        x: 1308,
        y: 630,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: -140,isArc: true, radius: 10 },
          { x: 140, y: -140 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
     {
      props: {
        shape: "polyline",
        x: 1470,
        y: 490,
        vertices: [
          { x: -5.66, y: -0.54 },
          { x: 300, y: 0 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
    {
      props: {
        shape: "polyline",
        x: 150,
        y: 890,
        vertices: [
          { x: 0, y: 0 },
          { x: 340, y: 0 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
       {
      props: {
        shape: "polyline",
        x: 1560,
        y: 630,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: -140,isArc: true, radius: 10 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
           {
      props: {
        shape: "polyline",
        x: 1200,
        y: 620,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: -460 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
           {
      props: {
        shape: "polyline",
        x: 1268,
        y: 520,
        vertices: [
          { x: -10, y: 0 },
          { x: -10, y: 110 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" },
        dash:[6, 6]
      }
    },
           {
      props: {
        shape: "polyline",
        x: 1200,
        y: 800,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: 190 }
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
      {
      props: {
        shape: "polyline",
        x: 400,
        y: 160,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: 110}
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
    {
      props: {
        shape: "polyline",
        
        x: 670,
        y: 160,
        vertices: [
          { x: 0, y: 0 },
          { x: 0, y: 110}
        ],
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
      {
      props: {
        shape: "polyline",
        x: 659,
        y: 262,
        vertices: [
          { x: 2.97, y: -0.09 },
          { x: 18, y: 0.02 },
           { x: 10.6, y: 10 },
          { x: 3.33, y: 0.02 },
          
        ],
        fillStyle: { style: "#666666" },
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
    {
      props: {
        shape: "polyline",
        x: 390,
        y: 262,
        vertices: [
          { x: 2.97, y: -0.09 },
          { x: 18, y: 0.02 },
           { x: 10.6, y: 10 },
          { x: 3.33, y: 0.02 },
          
        ],
        fillStyle: { style: "#666666" },
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
     {
      props: {
        shape: "polyline",
        x: 154,
        y: 262,
        vertices: [
          { x: 2.97, y: -0.09 },
          { x: 18, y: 0.02 },
           { x: 10.6, y: 10 },
          { x: 3.33, y: 0.02 },
          
        ],
        fillStyle: { style: "#666666" },
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
      {
      props: {
        shape: "polyline",
        x: 799,
        y: 768,
        vertices: [
          { x: 2.97, y: -0.09 },
          { x: 18, y: 0.02 },
           { x: 10.6, y: 10 },
          { x: 3.33, y: 0.02 },
          
        ],
        fillStyle: { style: "#666666" },
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
     {
      props: {
        shape: "polyline",
        x: 137.5,
        y: 890,
        vertices: [
         { x: 0,  y: -6 },
         { x: 0,  y: 6 },
         { x: 10, y: 0 },
         { x: 0,  y: -6 }
          
        ],
        fillStyle: { style: "#666666" },
        strokeStyle: { style: "#666666" },
        lw: { value: "3" }
      }
    },
    ////
     {
      props: {
        shape: "polyline",
        role:"staticLine",
        x: 48,
        y: 566,
        vertices: [
         { x: 0,  y: -6 },
         { x: 0,  y: -10 },
         { x: 732.02, y: -11.02 },
         { x: 732.02,  y: -4.87 }
          
        ],
        // fillStyle: { style: "#666666" },
        strokeStyle: { style: "#666666" },
        lw: { value: "2" }
      }
    },
    //   {
    //   props: {
    //     shape: "polyline",
    //     x: 20,
    //     y: 750,
    //     vertices: [
    //       { x: 0, y: 0 },
    //       { x: 770, y: 0 },
    //       { x: 770, y: -600 },
    //       { x: 0, y: -600 },
    //       { x: 0, y: 0 },
    //     ],
    //      fillStyle: { style: "#848484" },
    //     // strokeStyle: { style: "#aaa7a7" },
    //     lw: { value: "4" }
    //   }
    // },
    // {
    //   props: {
    //     shape: "polygon",
    //     x: 820,
    //     y: 760,
    //     vertices: [
    //     { x: 0, y: 0 },
    //     { x: 3.76, y: 0.06 },
    //     { x: -0.24, y: 5.06 },
    //     { x: -4.49, y: 0.06 },
    //     { x: 0, y: 0 },
    //     ],
    //     fillStyle: { style: "#666666" },
    //     strokeStyle: { style: "#666666" },
    //     lw: { value: 5 }
    //   }
    // },
 

//         {
//       props: {
//         shape: "rect",
//         x: 431,
//         y: 320,
//         vertices: [
//           { x: 0, y: 0 },
//           { x: 210, y: 0 },
//           { x: 210, y: 260 },
//           { x: 0, y: 260 }
//         ],
//         fillStyle: { style: "#ffffff" },
//         strokeStyle: { style: "#000000" },
//         lw: { value: 1 }
//       }
//     },
    //   {
    //   props: {
    //     shape: "polygon",
    //     x: 653,
    //     y: 218,
    //     vertices: [
    //       { x: 0, y: 0 },
    //       { x: 50, y: 0 },
    //       { x: 50, y: 50 },
    //       { x: 0, y: 50 }
    //     ],
    //     fillStyle: { style: "#ffffff" },
    //     strokeStyle: { style: "#000000" },
    //     lw: { value: 1 }
    //   }
    // },
    {
      props: {
        shape: "polygon",
        role: "device",
        x: 1190,
        y: 282,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
       fillStyle: { style: "#fc0000" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
    {
      props: {
        shape: "polygon",
        role: "device",
        x: 660,
        y: 218,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
       fillStyle: { style: "#33ff00" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
     {
      props: {
        shape: "polygon",
        role: "device",
        x: 390,
        y: 218,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
       fillStyle: { style: "#fc0000" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
       {
      props: {
        shape: "polygon",
        role: "device",
        x: 155,
        y: 218,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
       fillStyle: { style: "#33ff00" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
     {
      props: {
        shape: "polygon",
        role: "device",
        x: 1446,
        y: 282,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
       fillStyle: { style: "#33ff00" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
    {
      props: {
        shape: "polygon",
        role: "device",
        x: 1190,
        y: 940,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
       fillStyle: { style: "#fc0000" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
     {
      props: {
        shape: "polygon",
        role: "device",
        x: 1450,
        y: 940,
        vertices: [
          { x: 0, y: 0 },
          { x: 20, y: 0 },
          { x: -0, y: 30 },
          { x: 20, y: 30 },
          { x: 0, y: 0 }
        ],
      
       fillStyle: { style: "#33ff00" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
     {
      props: {
        shape: "polygon",
        role: "device",
        x: 400,
        y: 892,
        vertices: [
          { x:2.52, y: -1.5 },
          { x: -11.1, y: -11.45 },
          { x: -10.77, y: 7.22 },
          { x: 13.23, y: -11.45 },
          { x: 12.9, y: 6.88 },
          { x: 2.27, y: -1.75 }
        ],
      
       fillStyle: { style: "#fc0000" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
     {
      props: {
        shape: "polygon",
        role: "device",
        x: 897.27,
        y: 521.64,
        vertices: [
          { x:2.52, y: -1.5 },
          { x: -11.1, y: -11.45 },
          { x: -10.77, y: 7.22 },
          { x: 13.23, y: -11.45 },
          { x: 12.9, y: 6.88 },
          { x: 2.27, y: -1.75 }
        ],
      
       fillStyle: { style: "#fc0000" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
    // variable header
        {
      props: {
        shape: "polygon",
        x: 13,
        y: 133,
        vertices: [
          { x:0, y: 4.44 },
          { x: 1902, y: 5 },
          { x: 1902, y: -50 },
          { x: 0, y: -50 },
         
        ],
      
       fillStyle: { style: "#152748" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
         {
      props: {
        shape: "polygon",
        role: "device",
        x: 1040,
        y: 565,
        vertices: [
          { x:0, y: 0 },
          { x: -0.49, y:39.43 },
          { x: 39.51, y: 39.43 },
          { x: 40, y: 0 },
          { x: 0, y: 0 }, ],
      
       fillStyle: { style: "#0eea50" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
         {
      props: {
        shape: "polygon",
        role: "device",
        x: 1040,
        y: 470,
        vertices: [
          { x:0, y: 0 },
          { x: -0.49, y:39.43 },
          { x: 39.51, y: 39.43 },
          { x: 40, y: 0 },
          { x: 0, y: 0 },

         
        ],
      
       fillStyle: { style: "#0eea50" },
        strokeStyle: { style: "#000000" },
        lw: { value: 1 }
      }
    },
    // // BACKGROUND
    //   {
    //   props: {
    //     shape: "polygon",
    //     x: 20,
    //     y: 750,
    //     vertices: [
    //       { x:0, y: 0 },
    //       { x: 770, y: 0 },
    //       { x: 770, y: -600 },
    //       { x: 0, y: -600 },
    //       { x: 0, y: 0 },
          
         
    //     ],
      
    //   fillStyle: { style: "#666666" },
    //     strokeStyle: { style: "#666666" },
    //     lw: { value: 1 }
    //   }
    // },
    // background shape
    {
  props: {
    shape: "polygon",
    x: 1700,   // unchanged
    y: 493,    // unchanged

    vertices: [
      { x: 1.51,  y: -1.03,  isArc: true, radius: 6 },
      { x: -2.2,     y: 8.47 },
      { x: -90, y: 10,isArc: true, radius: 6  },
      { x: -90,    y: 40,isArc: true, radius: 6  },
      { x: 60, y: 40,isArc: true, radius: 6 },
      { x: 60,   y: 10,    isArc: true, radius: 6 },
      { x: 6.38,y: 9.18 },
      { x: 2.18,  y: -1.03 }
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
    {
  props: {
    shape: "polygon",
    x: 1655,   // unchanged
    y: 492,    // unchanged

    vertices: [
       { "x": -6, "y": -2.55,    isArc: true, radius: 6  },
    { "x": -10, "y": -10,  },
    { "x": -46.44, "y": -10.18,    isArc: true, radius: 6  },
    { "x": -45.94, "y": -39.18,    isArc: true, radius: 6  },
    { "x": 105.06, "y": -39.18,    isArc: true, radius: 6  },
    { "x": 104.56, "y": -10.18,    isArc: true, radius: 6  },
    { "x": 0, "y": -10 ,    },
    { "x": -5.23, "y": -3.32,    isArc: true, radius: 6  }
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
 {
  props: {
    shape: "polygon",
    x: 1203,   // unchanged
    y: 225,    // unchanged

    vertices: [
      { x: 0,  y: 0},
      { x:0,     y: 0 },
      { x:10,    y:5.33 },
      { x:10.4, y: 22.13,isArc: true, radius: 6 },
      { x: 116.8,   y:21.73,    isArc: true, radius: 6 },
      { x: 117.2,y: -21.87, isArc: true, radius: 6 },
      { x: 10,  y: -21.87, isArc: true, radius: 6 },
      { x: 9.6,  y: -4.27 },
      { x: 0,  y: 0},
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
{
  props: {
    shape: "polygon",
    x: 1203,   // unchanged
    y: 360,    // unchanged

    vertices: [
      { x: 0,  y: 0},
      { x:0,     y: 0 },
      { x:10,    y:5.33 },
      { x:10.4, y: 22.13,isArc: true, radius: 6 },
      { x: 116.8,   y:21.73,    isArc: true, radius: 6 },
      { x: 117.2,y: -21.87, isArc: true, radius: 6 },
      { x: 10,  y: -21.87, isArc: true, radius: 6 },
      { x: 9.6,  y: -4.27 },
      { x: 0,  y: 0},
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
{
  props: {
    shape: "polygon",
    x: 1460,   // unchanged
    y: 225,    // unchanged

    vertices: [
      { x: 0,  y: 0},
      { x:0,     y: 0 },
      { x:10,    y:5.33 },
      { x:10.4, y: 22.13,isArc: true, radius: 6 },
      { x: 116.8,   y:21.73,    isArc: true, radius: 6 },
      { x: 117.2,y: -21.87, isArc: true, radius: 6 },
      { x: 10,  y: -21.87, isArc: true, radius: 6 },
      { x: 9.6,  y: -4.27 },
      { x: 0,  y: 0},
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
{
  props: {
    shape: "polygon",
    x: 1460,   // unchanged
    y: 360,    // unchanged

    vertices: [
      { x: 0,  y: 0},
      { x:0,     y: 0 },
      { x:10,    y:5.33 },
      { x:10.4, y: 22.13,isArc: true, radius: 6 },
      { x: 116.8,   y:21.73,    isArc: true, radius: 6 },
      { x: 117.2,y: -21.87, isArc: true, radius: 6 },
      { x: 10,  y: -21.87, isArc: true, radius: 6 },
      { x: 9.6,  y: -4.27 },
      { x: 0,  y: 0},
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
{
  props: {
    shape: "polygon",
    x: 862,   // unchanged
    y: 169,    // unchanged

    vertices: [
      { x: 0.19,  y: -2.83},
      { x:-1.37,     y:2.04},
      { x:-46.51,    y:2.61, isArc: true, radius: 6 },
      { x:-46.51, y: 30.77,isArc: true, radius: 6 },
      { x: 103.69,   y:30.77,    isArc: true, radius: 6 },
      { x: 103.78,y: 2.04, isArc: true, radius: 6 },
      { x: 4.92,  y: 1.47 },
      { x: 1.78,  y: -7.67 },
      { x: 0,  y: 0},
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
   {
  props: {
    shape: "polygon",
    x: 290,   // unchanged
    y: 893,    // unchanged

    vertices: [
      { x: 1.51,  y: -1.03,  isArc: true, radius: 6 },
      { x: -2.2,     y: 8.47 },
      { x: -90, y: 10,isArc: true, radius: 6  },
      { x: -90,    y: 40,isArc: true, radius: 6  },
      { x: 60, y: 40,isArc: true, radius: 6 },
      { x: 60,   y: 10,    isArc: true, radius: 6 },
      { x: 6.38,y: 9.18 },
      { x: 2.18,  y: -1.03 }
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
{
  props: {
    shape: "polygon",
    x: 245,   // unchanged
    y: 890,    // unchanged

    vertices: [
        { "x": -6, "y": -2.55,     },
    { "x": -10, "y": -10,      },
    { "x": -46.44, "y": -10.18,    isArc: true, radius: 6  },
    { "x": -45.94, "y": -39.18,    isArc: true, radius: 6  },
    { "x": 105.06, "y": -39.18,    isArc: true, radius: 6  },
    { "x": 104.56, "y": -10.18,    isArc: true, radius: 6  },
    { "x": 0, "y": -10 , },
    { "x": -5.23, "y": -3.32,    isArc: true, radius: 6  }
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
{
  props: {
    shape: "polygon",
    x: 810,   // unchanged
    y: 630,    // unchanged

    vertices: [
      { x: 0,  y: 0},
      { x:0,     y: 0 },
      { x:10,    y:5.33 },
      { x:10.4, y: 22.13,isArc: true, radius: 6 },
      { x: 116.8,   y:21.73,    isArc: true, radius: 6 },
      { x: 117.2,y: -21.87, isArc: true, radius: 6 },
      { x: 10,  y: -21.87, isArc: true, radius: 6 },
      { x: 9.6,  y: -4.27 },
      { x: 0,  y: 0},
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
   {
  props: {
    shape: "polygon",
    x: 910,   // unchanged
    y: 992,    // unchanged

    vertices: [
       { "x": -6, "y": -2.55, },
    { "x": -10, "y": -10,    },
    { "x": -46.44, "y": -10.18,    isArc: true, radius: 6  },
    { "x": -45.94, "y": -39.18,    isArc: true, radius: 6  },
    { "x": 105.06, "y": -39.18,    isArc: true, radius: 6  },
    { "x": 104.56, "y": -10.18,    isArc: true, radius: 6  },
    { "x": 0, "y": -10 ,},
    { "x": -5.23, "y": -3.32,    isArc: true, radius: 6  }
    ],

    fillStyle: { style: "#cacaca" },
    // strokeStyle: { style: "#000000" },
    lw: { value: 1 }
  }
},
  {
  props: {
    shape: "text",
    x: 940,
    y: 960,
    text: "66.4",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
     {
  props: {
    shape: "text",
    role: "staticText",
    x: 985,
    y: 965,
    text: "PSI",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
//HEADER TEXT
      {
  props: {
    shape: "text",
    role: "staticText",
    x: 22,
    y: 108,
    text: "BULDING WATER FEED",
    fontSize: 35,
    fontFamily: "Arial",
    fillStyle: { style: "#f5f5f8" },
    layer:"front"
  }
},
   {
  props: {
    shape: "text",
    role: "staticText",
    x: 23,
    y: 90,
    text: "MCF2M3-FEEDWTR",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#5D677A" },
    layer:"front"
  }
},
// MOTOR VALUE
        {
  props: {
    shape: "text",
    x: 1682,
    y: 461,
    text: "42.0",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
     {
  props: {
    shape: "text",
    role: "staticText",
    x: 1728,
    y: 466,
    text: "PSI",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
     {
  props: {
    shape: "text",
    x: 1675,
    y: 510,
    text: "20.3",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
     {
  props: {
    shape: "text",
    role: "staticText",
    x: 1720,
    y: 516,
    text: "GPM",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
 {
  props: {
    shape: "text",
    x: 1266,
    y: 206,
    text: "1493",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 1290,
    y: 228,
    text: "PSI",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},

 {
  props: {
    shape: "text",
    x: 1541,
    y: 206,
    text: "0.0",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    x: 1548,
    y: 228,
    text: "PSI",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    x: 1270,
    y: 343,
    text: "90.2",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1280,
    y: 365,
    text: "GPM",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
        {
  props: {
    shape: "text",
    x: 840,
    y: 630,
    text: "10.8",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
     {
  props: {
    shape: "text",
    role: "staticText",
    x: 888,
    y: 635,
    text: "GPM",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    x: 880,
    y: 178,
    text: "90.2",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 925,
    y: 183,
    text: "GPM",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    x: 1543,
    y: 342,
    text: "0.0",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" },
    layer:"front"
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1540,
    y: 363,
    text: "GPM",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" },
    layer:"front"
  }
},
        {
  props: {
    shape: "text",
    x: 870,
    y: 532,
    text: "40.1",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
        {
  props: {
    shape: "text",
    x: 80,
    y: 563,
    text: "65.1",
    fontSize: 33,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
        {
  props: {
    shape: "text",
    role: "staticText",
    x: 145,
    y: 573,
    text: "PSI",
    fontSize: 20,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
       {
  props: {
    shape: "text",
    x: 316,
    y: 563,
    text: "65.8",
    fontSize: 33,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
     {
  props: {
    shape: "text",
    role: "staticText",
    x: 385,
    y: 573,
    text: "PSI",
    fontSize: 20,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
     {
  props: {
    shape: "text",
    x: 574,
    y: 564.75,
    text: "65.1",
    fontSize: 33,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
  {
  props: {
    shape: "text",
    role: "staticText",
    x: 640,
    y: 573,
    text: "PSI",
    fontSize: 20,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
  {
  props: {
    shape: "text",
    x: 275,
    y: 860,
    text: "68.4",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
  {
  props: {
    shape: "text",
    role: "staticText",
    x: 320,
    y: 865,
    text: "PSI",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    x: 270,
    y: 910,
    text: "102",
    fontSize: 23,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 310,
    y: 915,
    text: "GPM",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
  {
  props: {
    shape: "text",
    role: "staticText",
    x: 308.75,
    y: 538.75,
    text: "CONSTANT PRESS PUMP SET",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    x: 54,
    y: 684,
    text: "104",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    x: 167,
    y: 684,
    text: "0.0",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    x: 288,
    y: 684,
    text: "0.0",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    x: 396,
    y: 682,
    text: "104",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    x: 553,
    y: 684,
    text: "104",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    x:663,
    y: 684,
    text: "104",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
{
  props: {
    shape: "text",
    x:1216,
    y: 736,
    text: "104",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#0000EE" }
  }
},
//
        {
  props: {
    shape: "text",
    role: "staticText",
    x: 20,
    y: 880,
    text: "CITY WATER",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
     {
  props: {
    shape: "text",
    role: "staticText",
    x: 40,
    y: 900,
    text: "INLET",
    fontSize: 16,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
//VALVE TEXT
   {
  props: {
    shape: "text",
    role: "staticText",
    x: 107,
    y: 215,
    text: "FILL",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 105,
    y: 230,
    text: "505A",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
  {
  props: {
    shape: "text",
    role: "staticText",
    x: 344,
    y: 215,
    text: "FILL",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 340,
    y: 230,
    text: "505B",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 613,
    y: 215,
    text: "FILL",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 608,
    y: 230,
    text: "505C",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1103,
    y: 280,
    text: "HP DISCH",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 1140,
    y: 295,
    text: "503A",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1358,
    y: 284,
    text: "HP DISCH",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 1395,
    y: 299,
    text: "503B",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1132,
    y: 939,
    text: "SUCT",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 1138,
    y: 955,
    text: "502A",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1395,
    y: 939,
    text: "SUCT",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 1399,
    y: 955,
    text: "502B",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 380,
    y: 830,
    text: "INLET",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 386,
    y: 845,
    text: "501",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 870,
    y: 465,
    text: "RECIRC",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 885,
    y: 478,
    text: "504",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
 {
  props: {
    shape: "text",
    role: "staticText",
    x: 980,
    y: 422,
    text: "CLOSED TEMP CTRL",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1033,
    y: 454,
    text: "UNIT A",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 1033,
    y: 547,
    text: "UNIT B",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
{
  props: {
    shape: "text",
    role: "staticText",
    x: 918,
    y: 538,
    text: "PCT",
    fontSize: 15,
    fontFamily: "Arial",
    fillStyle: { style: "#666666" }
  }
},
// {
//   props: {
//     shape: "text",
//     role: "staticText",
//     x: 1210,
//     y: 730,
//     text: "104",
//     fontSize: 15,
//     fontFamily: "Arial",
//     fillStyle: { style: "#666666" }
//   }
// },
// {
//   props: {
//     shape: "text",
//     role: "staticText",
//     x: 1470,
//     y: 730,
//     text: "0.0",
//     fontSize: 15,
//     fontFamily: "Arial",
//     fillStyle: { style: "#666666" }
//   }
// },
//         {
//   props: {
//     shape: "text",
//     x: 530,
//     y: 290,
//     text: "R",
//     fontSize: 18,
//     fontFamily: "Arial",
//     fillStyle: { style: "#666666" }
//   }
// },
//         {
//   props: {
//     shape: "text",
//     x: 500,
//     y: 500,
//     text: "TANK - 501 ",
//     fontSize: 14,
//     fontFamily: "Arial",
//     fillStyle: { style: "#666666" }
//   }
// },
    //     {
    //   props: {
    //     shape: "polygon",
    //     x: 1338.86,
    //     y: 540,
    //     vertices: [
    //       { x: 0, y: 0 },
    //       { x: 20, y: 0 },
    //       { x: -0, y: 30 },
    //       { x: 20, y: 30 },
    //       { x: 0, y: 0 }
    //     ],
    //    fillStyle: { style: "#ffffff" },
    //     strokeStyle: { style: "#000000" },
    //     lw: { value: 1 }
    //   }
    // },
    // {
    //   props: {
    //     shape: "polygon",
    //     x: 1164,
    //     y: 285,
    //     vertices: [
    //       { x: 0, y: 0 },
    //       { x: 124, y: 0 },
    //       { x: 124, y: 124 },
    //       { x: 0, y: 124 },
    //       { x: 0, y: 0 }
    //     ],
    //    fillStyle: { style: "#ffffff" },
    //     strokeStyle: { style: "#000000" },
    //     lw: { value: 1 }
    //   }
    // },
//             {
//       props: {
//         shape: "rect",
//         x: 1164,
//         y: 285,
//         vertices: [
//           { x: 0, y: 0 },
//           { x: 124, y: 0 },
//           { x: 124, y: 124 },
//           { x: 0, y: 124 }
//         ],
//         fillStyle: { style: "#a6a6a6" },
//         strokeStyle: { style: "#ffffff" },
//         lw: { value: 1 }
//       }
//     },
//            {
//       props: {
//         shape: "triangle",
//         x: 1292,
//         y: 402,
//         vertices: [
//           { x: 15, y: 0 },
//           { x: 15, y: -15 },
//           { x: 0, y: -7.5 }
//         ],
//         fillStyle: { style: "#666666" },
//         strokeStyle: { style: "#666666" },
//         lw: { value: 1 }
//       }
//     },
//                {
//       props: {
//         shape: "triangle",
//         x: 983,
//         y: 690,
//         vertices: [
//           { x: 0, y: 0 },
//           { x: 7.5, y: 15  },
//           { x: 15, y: 0 }
//         ],
//         fillStyle: { style: "#666666" },
//         strokeStyle: { style: "#666666" },
//         lw: { value: 1 }
//       }
//     },



 ],

  canvasWidth: 1920,
  canvasHeight: 1041,
  canvasColor: { style: "#b3b3b3" }
};

 //AUTO ROLE ASSIGN

jsonData.shapes.forEach(s => {
  if (s.props.shape === "polyline" && !s.props.role) s.props.role = "line";
  if (s.props.shape === "text" && !s.props.role) s.props.role = "text";
  if (s.props.shape === "polygon" && s.props.role === "device" && !s.props.role) s.props.role = "device";
});

 //GLOBAL STATE
 
let pumpStartColor = "#0eea50";
let pumpClosedColor = "#ec0707";


//SHARED COLOR PICKER TARGET

let currentTarget = null;
const palette = document.getElementById("colorPalette");

//OPEN POPUP NEAR BUTTON

function openPaletteNearButton(button) {

  const rect = button.getBoundingClientRect();

  palette.style.display = "block";

  const popupWidth = palette.offsetWidth;
  const popupHeight = palette.offsetHeight;

  let left = rect.right + 10;
  let top = rect.top;

  // right overflow handle
  if (left + popupWidth > window.innerWidth) {
    left = rect.left - popupWidth - 10;
  }

  // bottom overflow handle
  if (top + popupHeight > window.innerHeight) {
    top = window.innerHeight - popupHeight - 10;
  }

  palette.style.left = left + "px";
  palette.style.top = top + "px";

  palette.classList.add("show");
}
//prevent popup closing when clicking inside 
palette.addEventListener("click", e => {
  e.stopPropagation();
});

// //BUTTON → OPEN COLOR PANEL 

// document.getElementById("polylineBtn").onclick = e => {
//   e.stopPropagation();
//   currentTarget = "line";
//   openPaletteNearButton(e.target);
// };

// document.getElementById("polygonBtn").onclick = e => {
//   e.stopPropagation();
//   currentTarget = "device";
//   openPaletteNearButton(e.target);
// };

// document.getElementById("textBtn").onclick = e => {
//   e.stopPropagation();
//   currentTarget = "text";
//   openPaletteNearButton(e.target);
// };

// document.getElementById("pStartBtn").onclick = e => {
//   e.stopPropagation();
//   currentTarget = "pumpStart";
//   openPaletteNearButton(e.target);
// };

// document.getElementById("pClosedBtn").onclick = e => {
//   e.stopPropagation();
//   currentTarget = "pumpClosed";
//   openPaletteNearButton(e.target);
// };
document.querySelectorAll(".control-row").forEach(row=>{
  row.addEventListener("click", e=>{
    e.stopPropagation();

    currentTarget = row.dataset.target;

    openPaletteNearButton(row);
  });
});

//CLOSE ONLY ON REAL OUTSIDE CLICK
document.addEventListener("click", (e) => {

  // palette ke andar click → ignore
  if (palette.contains(e.target)) return;

  // color open karne wale buttons → ignore
  if (
    e.target.closest("#polylineBtn") ||
    e.target.closest("#polygonBtn") ||
    e.target.closest("#textBtn") ||
    e.target.closest("#pStartBtn") ||
    e.target.closest("#pClosedBtn")
  ) return;

  // baaki sab → close
 palette.classList.remove("show");
 palette.style.display = "none";
});


 // CANVAS SETUP

const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
function renderScene() {
  draw();        // draw shapes
  drawAllSVGs(); // draw all svg
}


const DPR = window.devicePixelRatio || 1;
const W = Number(jsonData.canvasWidth);
const H = Number(jsonData.canvasHeight);

canvas.width = W * DPR;
canvas.height = H * DPR;
canvas.style.width = W + "px";
canvas.style.height = H + "px";

ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
ctx.lineJoin = "round";
ctx.lineCap = "round";

function draw() {
  // background
  ctx.fillStyle = jsonData.canvasColor?.style || "#ffffff";
  ctx.fillRect(0, 0, W, H);

  jsonData.shapes.forEach(shape => {
    const p = shape.props;
    if (!p) return;

    // text shapes don't use vertices — draw and continue
    if (p.shape === "text") {
      ctx.fillStyle = p.fillStyle?.style || "#000";
      ctx.font = `${p.fontSize || 12}px ${p.fontFamily || "Arial"}`;
      ctx.textBaseline = "top";

       ctx.fillText(p.text, p.x, p.y,);



      // optional box (for "A")
      if (p.boxed) {
        const metrics = ctx.measureText(p.text);
        const padding = 4;

        ctx.strokeStyle = p.fillStyle.style;
        ctx.strokeRect(
          p.x - padding,
          p.y - padding,
          metrics.width + padding * 2,
          (p.fontSize || 12) + padding * 2
        );
      }

      return;
    }

    if (!p.vertices || p.vertices.length < 2) return;

    ctx.beginPath();

    // move to first point
    ctx.moveTo(
      p.x + p.vertices[0].x,
      p.y + p.vertices[0].y
    );

// iterate vertices
for (let i = 1; i < p.vertices.length; i++) {
  const v = p.vertices[i];
  const next = p.vertices[i + 1]; // look ahead
 
  if (v.isQuad && v.controlPts && v.controlPts.length > 0) {
    const cp = v.controlPts[0];
    ctx.quadraticCurveTo(
      p.x + cp.x,
      p.y + cp.y,
      p.x + v.x,
      p.y + v.y
    );
  } else if (v.isArc && next) {
    // Rounded corner
    ctx.arcTo(
      p.x + v.x,   // corner point
      p.y + v.y,
      p.x + next.x, // next point
      p.y + next.y,
      v.radius || 20 // radius of curve
    );
  } else {
    // Straight line
    ctx.lineTo(
      p.x + v.x,
      p.y + v.y
    );
  }
}

    

    // close polygon
    if (p.shape === "polygon") {
      ctx.closePath();
    }

    // fill (polygons)
    if (p.fillStyle?.style && p.fillStyle.style !== "None") {
      ctx.fillStyle = p.fillStyle.style;
      ctx.fill();
    }

    // stroke (both)
    // if (p.strokeStyle?.style && p.strokeStyle.style !== "None") {
    //   ctx.strokeStyle = p.strokeStyle.style;
    //   ctx.lineWidth = Number(p.lw?.value || 1);
    //   ctx.stroke();
    // }

// stroke (both)
if (p.strokeStyle?.style && p.strokeStyle.style !== "None") {
  ctx.strokeStyle = p.strokeStyle.style;
  ctx.lineWidth = Number(p.lw?.value || 1);

  // DASH SUPPORT
  if (p.dash) {
    ctx.setLineDash(p.dash);   // dotted line
  } else {
    ctx.setLineDash([]);       // solid line
  }

  ctx.lineCap = "round";       // round dots
  ctx.lineJoin = "round";      // smooth corners

  ctx.stroke();
}

   });
}

function drawAllSVGs(color) {
  drawSVGOnCanvas('./TANK WEST 1.svg',49,274,190,250);
  drawSVGOnCanvas('./A2 (2).svg',1145,620,230,185,); 
  drawSVGOnCanvas('./B.svg',1405,620,230,185); 
  drawSVGOnCanvas('./TANK NORTH 1.svg',278,274,190,250);
  drawSVGOnCanvas('./TANK EAST 1.svg',500,274,270,250);
  drawSVGOnCanvas('./A1.svg',40,610,80,95);
  drawSVGOnCanvas('./A2.svg',150,610,80,95);
  drawSVGOnCanvas('./B1.svg',271,610,80,95);
  drawSVGOnCanvas('./BN.svg',381,610,80,95);
  drawSVGOnCanvas('./C1.svg',540,610,80,95);
  drawSVGOnCanvas('./C2.svg',649,610,80,95);
  drawSVGOnCanvas('./Cistern (2).svg',490,780,360,250,);
  drawSVGOnCanvas('./SP.svg',1640,160,250,240,);
  drawSVGOnCanvas('./RC.svg',1170,880,55,30,);
  drawSVGOnCanvas('./RC.svg',1430,880,55,30,);
  drawSVGOnCanvas('./LPC.svg',1772,470,124,50,);
  drawSVGOnCanvas('./Header N.svg',12,4.22,1902.64,78.28,);
  // const initColor19 = '#ec0707';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',668,650,39.5,32,pumpClosedColor);
  // const initColor20 = '#ec0707';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',560,650,39.5,32,pumpClosedColor);
  // const initColor21 = '#ec0707';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',400,648,39.5,32,pumpClosedColor);
    // const initColor22 = '#0eea50';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',291,650,39.5,32,pumpStartColor);
    // const initColor23 = '#0eea50'; 
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',170,650,39.5,32,pumpStartColor); 
    //  const initColor24 = '#ec0707';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',57,650,39.5,32,pumpClosedColor);
    // const initColor25 = '#ec0707';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',1240,690,39.5,32,pumpClosedColor);
    // const initColor26 = '#0eea50';
  drawSVGOnCanvas('./FlatCentrifugalPump2.svg',1500,692,39.5,32,pumpStartColor); 
  drawSVGOnCanvas('./SECURITY.svg',997,104,154,35,);
  drawSVGOnCanvas('./FIRE.svg',1150,104,154,35,);
  drawSVGOnCanvas('./WATER.svg',1303,104,154,35,);
  drawSVGOnCanvas('./ELECT.svg',1456,104,154,35,);
  drawSVGOnCanvas('./HVAC.svg',1609,104,154,35,);
  drawSVGOnCanvas('./SERVICE.svg',1762,104,154,35,);
  drawSVGOnCanvas('./R.svg',70,658,12,9,);
  drawSVGOnCanvas('./R.svg',412,657,12,9,);
  drawSVGOnCanvas('./R.svg',573,657,12,9,);
  drawSVGOnCanvas('./R.svg',680,657,12,9,);
  drawSVGOnCanvas('./R.svg',1253,698,12,9,);
  drawSVGOnCanvas('./S.svg',183,657,12,9,);
  drawSVGOnCanvas('./S.svg',304,657,12,9,);
  drawSVGOnCanvas('./S.svg',1513,698,12,9,);
  drawSVGOnCanvas('./C.svg',142,221,25,20,);
  drawSVGOnCanvas('./O.svg',376,221,25,20,);
  drawSVGOnCanvas('./C.svg',646,221,25,20,);
  drawSVGOnCanvas('./O.svg',1176,285,25,20,);
  drawSVGOnCanvas('./C.svg',1432,285,25,20,);
  drawSVGOnCanvas('./O.svg',1175,943,25,20,);
  drawSVGOnCanvas('./C.svg',1436,943,25,20,);
  drawSVGOnCanvas('./VC.svg',391,860,20,29,);
  drawSVGOnCanvas('./A (1).svg',985,465,40,40,);
  drawSVGOnCanvas('./B (1).svg',985,561,40,40,);
  drawSVGOnCanvas('./PINK.svg',1348,260,165,60,);
  drawSVGOnCanvas('./U (2).svg',885,496,26,23,);
  drawSVGOnCanvas('./58.1.svg',143,469,40,15,color);
  drawSVGOnCanvas('./51.2.svg',375,469,40,15,color);
  drawSVGOnCanvas('./86.4.svg',650,469,40,15,color);
  drawSVGOnCanvas('./47.5.svg',1683,318,35,15,color);
  drawSVGOnCanvas('./6.2.svg',1750,318,35,15,color);
  drawSVGOnCanvas('./104.svg',1215,740,35,15,color);
  drawSVGOnCanvas('./0.0.svg',1485,736,30,15,color);
  drawSVGOnCanvas('./7.2.svg',1815,318,35,15,color);
  drawSVGOnCanvas('./X.svg',662,942,35,15,color);
  drawSVGOnCanvas('./Y.svg',738,942,35,15,color);
  drawSVGOnCanvas('./CO.svg',1040,475,40,30,);
  drawSVGOnCanvas('./COO.svg',1033,562,55,45,);
  drawSVGOnCanvas('./FT.svg',670,960,30,12,);
  drawSVGOnCanvas('./DE.svg',740,960,30,12,);
      
  };

// ========================================
// 4. COLOR PALETTE (POLYLINE + POLYGON)
// ========================================
// document.querySelectorAll(".palette button").forEach(btn => {
//   btn.addEventListener("click", () => {
//     const color = btn.dataset.color;

//     jsonData.shapes.forEach(shape => {
//       const p = shape.props;

//       // polyline → stroke
//       if (p.shape === "polyline") {
//         p.strokeStyle.style = color;
//       }

//       // polygon → fill
//       if (p.shape === "polygon") {
//         p.fillStyle.style = color;
//       }
//     });

//     draw();
//   });
// });

// SVG cache store
const svgCache = {};

// main function
function drawSVGOnCanvas(url, x, y, w, h, color) {

  // already loaded → direct draw
  if (svgCache[url]) {
    renderSVG(svgCache[url], x, y, w, h, color);
    return;
  }

  // first time load
  const img = new Image();

  img.onload = () => {
    svgCache[url] = img; // store in cache
    renderSVG(img, x, y, w, h, color);
  };

  img.onerror = () => console.error("SVG load error:", url);

  img.src = url;
}

// actual renderer
function renderSVG(img, x, y, w, h, color) {
  if (!color) {
    ctx.drawImage(img, x, y, w, h);
    return;
  }

  const off = document.createElement("canvas");
  off.width = w;
  off.height = h;
  const octx = off.getContext("2d");

  octx.drawImage(img, 0, 0, w, h);
  octx.globalCompositeOperation = "source-in";
  octx.fillStyle = color;
  octx.fillRect(0, 0, w, h);

  ctx.drawImage(off, x, y);
}
//////////////////
function updateControlUI(color) {

  // hex input update
  if (hexInput) hexInput.value = color;

  // current selected row
  const activeRow = document.querySelector(
    `.control-row[data-target="${currentTarget}"]`
  );

  if (!activeRow) return;

  //preview box color change
  const previewBox =
    activeRow.querySelector(".color-preview") ||
    activeRow.querySelector(".preview-box") ||
    activeRow.querySelector(".color-box");

  if (previewBox) {
    previewBox.style.background = color;
  }

  // hex input in row update
  const input = activeRow.querySelector("input");
  if (input) input.value = color;
}

   //APPLY COLOR TO JSON DATA


function applyColor(color) {

  if (!currentTarget) return;

  /* LINE COLOR */
  if (currentTarget === "line") {
    jsonData.shapes.forEach(s => {
      if (s.props.role === "line") {
        s.props.strokeStyle.style = color;
      }
    });
  }

  //DEVICE COLOR 
  if (currentTarget === "device") {
    jsonData.shapes.forEach(s => {
      if (s.props.role === "device") {
        s.props.fillStyle.style = color;
      }
    });
  }

  // TEXT COLOR 
  if (currentTarget === "text") {
    jsonData.shapes.forEach(s => {
      if (s.props.role === "text") {
        s.props.fillStyle.style = color;
      }
    });
  }

  // PUMP COLORS 
  if (currentTarget === "pumpStart") {
    pumpStartColor = color;
  }

  if (currentTarget === "pumpClosed") {
    pumpClosedColor = color;
  }
updateControlUI(color);
  renderScene();   // redraw your canvas
}


//    COLOR PALETTE GRID


// const colors = [
// { name:"snow",hex:"#fffafa"},
// { name:"ghostwhite",hex:"#f8f8ff"},
// { name:"whitesmoke",hex:"#f5f5f5"},
// { name:"gainsboro",hex:"#dcdcdc"},
// { name:"floralwhite",hex:"#fffaf0"},
// { name:"oldlace",hex:"#fdf5e6"},
// { name:"linen",hex:"#faf0e6"},
// { name:"antiquewhite",hex:"#faebd7"},
// { name:"papayawhip",hex:"#ffefd5"},
// { name:"blanchedalmond",hex:"#ffebcd"},
// { name:"bisque",hex:"#ffe4c4"},
// { name:"peachpuff",hex:"#ffdab9"},
// { name:"navajowhite",hex:"#ffdead"},
// { name:"moccasin",hex:"#ffe4b5"},
// { name:"cornsilk",hex:"#fff8dc"},
// { name:"ivory",hex:"#fffff0"},
// { name:"lemonchiffon",hex:"#fffacd"},
// { name:"seashell",hex:"#fff5ee"},
// { name:"honeydew",hex:"#f0fff0"},
// { name:"mintcream",hex:"#f5fffa"},
// { name:"azure",hex:"#f0ffff"},
// { name:"aliceblue",hex:"#f0f8ff"},
// { name:"lavender",hex:"#e6e6fa"},
// { name:"lavenderblush",hex:"#fff0f5"},
// { name:"mistyrose",hex:"#ffe4e1"},
// { name:"white",hex:"#ffffff"},
// { name:"black",hex:"#000000"},
// { name:"red",hex:"#ff0000"},
// { name:"green",hex:"#008000"},
// { name:"blue",hex:"#0000ff"},
// { name:"yellow",hex:"#ffff00"},
// { name:"cyan",hex:"#00ffff"},
// { name:"magenta",hex:"#ff00ff"},
// { name:"silver",hex:"#c0c0c0"},
// { name:"gray",hex:"#808080"},
// { name:"maroon",hex:"#800000"},
// { name:"olive",hex:"#808000"},
// { name:"purple",hex:"#800080"},
// { name:"teal",hex:"#008080"},
// { name:"navy",hex:"#000080"},
// { name:"orange",hex:"#ffa500"},
// { name:"orangered",hex:"#ff4500"},
// { name:"tomato",hex:"#ff6347"},
// { name:"coral",hex:"#ff7f50"},
// { name:"salmon",hex:"#fa8072"},
// { name:"lightsalmon",hex:"#ffa07a"},
// { name:"gold",hex:"#ffd700"},
// { name:"khaki",hex:"#f0e68c"},
// { name:"darkkhaki",hex:"#bdb76b"},
// { name:"pink",hex:"#ffc0cb"},
// { name:"hotpink",hex:"#ff69b4"},
// { name:"deeppink",hex:"#ff1493"},
// { name:"palevioletred",hex:"#db7093"},
// { name:"mediumvioletred",hex:"#c71585"},
// { name:"lightgreen",hex:"#90ee90"},
// { name:"lime",hex:"#00ff00"},
// { name:"limegreen",hex:"#32cd32"},
// { name:"forestgreen",hex:"#228b22"},
// { name:"darkgreen",hex:"#006400"},
// { name:"lawngreen",hex:"#7cfc00"},
// { name:"springgreen",hex:"#00ff7f"},
// { name:"mediumspringgreen",hex:"#00fa9a"},
// { name:"turquoise",hex:"#40e0d0"},
// { name:"lightseagreen",hex:"#20b2aa"},
// { name:"dodgerblue",hex:"#1e90ff"},
// { name:"deepskyblue",hex:"#00bfff"},
// { name:"skyblue",hex:"#87ceeb"},
// { name:"lightskyblue",hex:"#87cefa"},
// { name:"steelblue",hex:"#4682b4"},
// { name:"royalblue",hex:"#4169e1"},
// { name:"midnightblue",hex:"#191970"},
// { name:"indigo",hex:"#4b0082"},
// { name:"darkviolet",hex:"#9400d3"},
// { name:"darkorchid",hex:"#9932cc"},
// { name:"mediumorchid",hex:"#ba55d3"},
// { name:"plum",hex:"#dda0dd"},
// { name:"thistle",hex:"#d8bfd8"},
// { name:"tan",hex:"#d2b48c"},
// { name:"rosybrown",hex:"#bc8f8f"},
// { name:"sandybrown",hex:"#f4a460"},
// { name:"chocolate",hex:"#d2691e"},
// { name:"saddlebrown",hex:"#8b4513"},
// { name:"brown",hex:"#a52a2a"},
// { name:"firebrick",hex:"#b22222"},
// { name:"darkred",hex:"#8b0000"}
// ];


   //AUTO GENERATE 500+ COLORS


function generateColors(){
  const list = [];

  for(let h=0; h<=360; h+=10){      // hue
    for(let s=60; s<=100; s+=20){   // saturation
      for(let l=40; l<=70; l+=15){  // lightness

        const hex = hslToHex(h,s,l);

        list.push({
          name:`h${h}-s${s}-l${l}`,
          hex:hex
        });
      }
    }
  }

  return list;
}

// HSL → HEX convert
function hslToHex(h,s,l){
  s/=100;
  l/=100;

  let c=(1-Math.abs(2*l-1))*s;
  let x=c*(1-Math.abs((h/60)%2-1));
  let m=l-c/2;
  let r=0,g=0,b=0;

  if(0<=h && h<60){r=c;g=x;b=0;}
  else if(60<=h && h<120){r=x;g=c;b=0;}
  else if(120<=h && h<180){r=0;g=c;b=x;}
  else if(180<=h && h<240){r=0;g=x;b=c;}
  else if(240<=h && h<300){r=x;g=0;b=c;}
  else{r=c;g=0;b=x;}

  r=Math.round((r+m)*255);
  g=Math.round((g+m)*255);
  b=Math.round((b+m)*255);

  return "#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1);
}

const colors = generateColors();
const grid = document.getElementById("colorGrid");

//create color boxes 
function renderColors(list){
  if(!grid) return;

  grid.innerHTML="";

  list.forEach(c=>{
    const box=document.createElement("div");
    box.className="color-box";
    box.style.background=c.hex;

    box.innerHTML=`
      <div class="color-name">${c.name}</div>
      <div class="color-hex">${c.hex}</div>
    `;

    // APPLY COLOR WHEN CLICK 
    box.onclick=()=>{
      applyColor(c.hex);
    };

    grid.appendChild(box);
  });
}

renderColors(colors);


  // CLOSE ON RESIZE / ZOOM


window.addEventListener("resize", () => {
  palette.classList.remove("show");
});

// search filter
const search=document.getElementById("colorSearch");
if(search){
  search.addEventListener("input",e=>{
    const v=e.target.value.toLowerCase();
    renderColors(colors.filter(c =>
      c.name.includes(v) || c.hex.includes(v)
    ));
  });
}


renderScene();


 //FULL COLOR SPECTRUM (UNLIMITED COLORS)


const spectrum = document.getElementById("colorSpectrum");
const hexInput = document.getElementById("hexInput");

if (spectrum) {
  const spCtx = spectrum.getContext("2d");

  // rainbow gradient
  const grad1 = spCtx.createLinearGradient(0, 0, spectrum.width, 0);
  grad1.addColorStop(0, "red");
  grad1.addColorStop(0.17, "yellow");
  grad1.addColorStop(0.34, "lime");
  grad1.addColorStop(0.51, "cyan");
  grad1.addColorStop(0.68, "blue");
  grad1.addColorStop(0.85, "magenta");
  grad1.addColorStop(1, "red");

  spCtx.fillStyle = grad1;
  spCtx.fillRect(0, 0, spectrum.width, spectrum.height);

  // white + black overlay (shades)
  const grad2 = spCtx.createLinearGradient(0, 0, 0, spectrum.height);
  grad2.addColorStop(0, "rgba(255,255,255,1)");
  grad2.addColorStop(0.5, "rgba(255,255,255,0)");
  grad2.addColorStop(0.5, "rgba(0,0,0,0)");
  grad2.addColorStop(1, "rgba(0,0,0,1)");

  spCtx.fillStyle = grad2;
  spCtx.fillRect(0, 0, spectrum.width, spectrum.height);

  // click → pick color
  spectrum.addEventListener("click", e => {
    const rect = spectrum.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    const pixel = spCtx.getImageData(x, y, 1, 1).data;
    const hex = rgbToHex(pixel[0], pixel[1], pixel[2]);

    if (hexInput) hexInput.value = hex;
    applyColor(hex);
  });
}

// rgb → hex convert
function rgbToHex(r, g, b) {
  return "#" + ((1 << 24) + (r << 16) + (g << 8) + b)
    .toString(16)
    .slice(1);
}

// manual hex input
if (hexInput) {
  hexInput.addEventListener("change", () => {
    applyColor(hexInput.value);
  });

}


